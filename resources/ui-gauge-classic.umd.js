(function(){"use strict";try{if(typeof document<"u"){var a=document.createElement("style");a.appendChild(document.createTextNode(".ui-gauge-cl-class[data-v-7a3aec5f]{color:green;font-weight:700}.cl-gauge[data-v-7a3aec5f]{position:relative}.cl-gauge .label[data-v-7a3aec5f]{fill:currentColor;font-size:.5rem;dominant-baseline:hanging}.cl-gauge .value[data-v-7a3aec5f]{fill:currentColor}.cl-gauge .units[data-v-7a3aec5f]{fill:currentColor;font-size:.4rem}.cl-gauge .measurement[data-v-7a3aec5f]{fill:currentColor;font-size:.5rem}.cl-gauge .num-wrap[data-v-7a3aec5f]{transform-origin:calc(var(--to-x) * 1%) calc(var(--to-y) * 1%);transform:rotate(calc(var(--t-r) * 1deg)) translate(calc(var(--tt-x) * 1%),calc(var(--tt-y) * 1%))}.cl-gauge .num[data-v-7a3aec5f]{fill:currentColor;fill-opacity:.6;font-size:.35rem}.cl-gauge .tick-minor[data-v-7a3aec5f]{fill:none;stroke:currentColor;stroke-opacity:.6}.cl-gauge .tick-major[data-v-7a3aec5f]{fill:none;stroke:currentColor}.cl-gauge .sector[data-v-7a3aec5f]{fill:none;stroke:transparent}.cl-gauge .o-needle[data-v-7a3aec5f]{transition:.5s}")),document.head.appendChild(a)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();
(function(o,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("vuex"),require("vue")):typeof define=="function"&&define.amd?define(["exports","vuex","vue"],h):(o=typeof globalThis<"u"?globalThis:o||self,h(o["ui-gauge-classic"]={},o.vuex,o.Vue))})(this,function(o,h,i){"use strict";const p=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},f={name:"UIGaugeClassic",inject:["$socket"],props:{id:{type:String,required:!0},props:{type:Object,default:()=>({})},state:{type:Object,default:()=>({enabled:!1,visible:!1})}},setup(t){},data(){return{min:0,max:1,majorDivision:10,minorDivision:5,units:"",label:"",measurement:"",valueDecimalPlaces:2,scaleDecimalPlaces:1,width:4,height:4,sectors:[],arc:{cx:50,cy:64,radius:47.5,startDegrees:-123,endDegrees:123,sweepAngle:246,startx:10,starty:90,endx:90,endy:90,arcLength:100},keepwidth:!0,hubcolor:"black",class:"",value:null,needles:[],widgetSizeRatio:1,unitsTextY:0,valueTextY:0,sectorStrokeStyles:[],majorTickStyle:"",minorTickStyle:"",formattedValue:null}},computed:{...h.mapState("data",["messages"]),wrapperStyle:function(){return""},arcspec:function(){const e=this.arc.endDegrees-this.arc.startDegrees>180?1:0;return`M ${this.arc.startx} ${this.arc.starty} A ${this.arc.radius} ${this.arc.radius} 0 ${e} 1 ${this.arc.endx} ${this.arc.endy}`},displayValue:function(){let t=this.formattedValue;return typeof t!="string"&&(t=this.value!==null?this.value.toFixed(this.valueDecimalPlaces):"---"),t},numbers:function(){return this.generateNumbers(this.min,this.max,this.majorDivision)},theViewBox(){let t=100*this.props.height/this.props.width;return(isNaN(t)||!t)&&(t=100),`0 0 100 ${t}`}},mounted(){this.$socket.on("widget-load:"+this.id,t=>{t.ui_update=t.my_ui_update,this.processMsg(t),this.keepwidth&&(this.$refs.wrapper.parentNode.style["grid-template-rows"]="repeat(0, var(--widget-row-height))",this.$refs.wrapper.parentNode.style["grid-row-end"]="span null")}),this.$socket.on("msg-input:"+this.id,t=>{this.processMsg(t),this.$store.commit("data/bind",{widgetId:this.id,msg:t})}),this.pickupProperties(),this.needles.forEach(t=>{t.rotation=this.rotation(null)}),this.$socket.emit("widget-load",this.id)},unmounted(){var t,e;(t=this.$socket)==null||t.off("widget-load:"+this.id),(e=this.$socket)==null||e.off("msg-input:"+this.id)},methods:{pickupProperties:function(){const t=this.props;this.min=Number(t.min),this.max=Number(t.max),this.width=Number(t.width),this.height=Number(t.height),this.sectors=t.sectors,this.majorDivision=Number(t.major_division),this.minorDivision=Number(t.minor_division),this.valueDecimalPlaces=Number(t.value_decimal_places),this.scaleDecimalPlaces=Number(t.scale_decimal_places),this.label=t.label,this.units=t.units,this.measurement=t.measurement,this.needles=t.needles,this.arc.sweepAngle=t.sweep_angle||246,this.keepwidth=t.keepwidth??!0,this.hubcolor=t.hubcolor??"black",this.class=t.myclass,this.calculateDerivedValues()},calcStrokeStyle:function(t){const e=this.sectors[t],r={minIn:this.min,maxIn:this.max,minOut:0,maxOut:this.arc.arcLength},n=this.range(e.start,r,!1);let s;t>=this.sectors.length-1?s=Math.max(this.max,this.min):s=this.sectors[t+1].start;const a=this.range(s,r,!1),c=Math.min(n,a),l=Math.max(n,a)-c;return`stroke-dasharray: 0 ${c} ${l} var(--dash); stroke: ${e.color};`},calculateDerivedValues:function(){this.majorDivision=this.majorDivision<=0?1:this.majorDivision,this.minorDivision=this.minorDivision<=0?1:this.minorDivision,this.arc.radius=47.5,this.label&&this.label.length>0?this.arc.cy=64:(this.arc.cy=50,this.height/this.width==.5&&(this.arc.radius-=2,this.arc.cy-=2.5)),this.calcTextPositions(),this.arc.sweepAngle&&(this.arc.sweepAngle=Math.min(360,this.arc.sweepAngle),this.arc.startDegrees=-this.arc.sweepAngle/2,this.arc.endDegrees=this.arc.sweepAngle/2);const n=this.arc.startDegrees*Math.PI/180,s=this.arc.endDegrees*Math.PI/180;this.arc.startx=this.arc.cx-this.arc.radius*Math.sin(n-Math.PI),this.arc.starty=this.arc.cy+this.arc.radius*Math.cos(n-Math.PI),this.arc.endx=this.arc.cx+this.arc.radius*Math.sin(Math.PI-s),this.arc.endy=this.arc.cy+this.arc.radius*Math.cos(Math.PI-s),this.arc.arcLength=2*Math.PI*this.arc.radius*(this.arc.endDegrees-this.arc.startDegrees)/360,this.widgetSizeRatio=this.height/this.width,(isNaN(this.widgetSizeRatio)||!this.widgetSizeRatio)&&(this.widgetSizeRatio=1),this.calcSectorStyles(),this.minorTickStyle=this.calcTickStyle(this.minorDivision,.5),this.majorTickStyle=this.calcTickStyle(this.majorDivision,1),this.needles.forEach(a=>{a.path=this.calcNeedlePath(a.lengthPercent,a.color)})},processMsg:function(t){var e,r,n,s;if(t.ui_update){if(Array.isArray((e=t.ui_update)==null?void 0:e.sectors)&&(this.sectors=t.ui_update.sectors),typeof((r=t.ui_update)==null?void 0:r.measurement)=="string"&&(this.measurement=t.ui_update.measurement),typeof((n=t.ui_update)==null?void 0:n.units)=="string"&&(this.units=t.ui_update.units),"sweepAngle"in t.ui_update){const a=Number(t.ui_update.sweepAngle);a>0&&a<=360&&(this.arc.sweepAngle=a)}["min","max","minorDivision","majorDivision","valueDecimalPlaces","scaleDecimalPlaces"].forEach(a=>{a in t.ui_update&&(this[a]=Number(t.ui_update[a]))}),"label"in t.ui_update&&typeof t.ui_update.label=="string"&&(this.label=t.ui_update.label),"hubcolor"in t.ui_update&&typeof t.ui_update.hubcolor=="string"&&(this.hubcolor=t.ui_update.hubcolor)}t._needlesChanged&&(this.needles=t.needles),("ui_update"in t||t._needlesChanged)&&(this.calculateDerivedValues(),this.calcSectorStyles(),this.minorTickStyle=this.calcTickStyle(this.minorDivision,.5),this.majorTickStyle=this.calcTickStyle(this.majorDivision,1),this.recalcNeedlePositions()),typeof t.formattedValue=="string"?this.formattedValue=t.formattedValue:this.formattedValue=null,t.needles&&this.needles.forEach((a,c)=>{var u;const l=this.validate((u=t.needles[c])==null?void 0:u.value);a.value=l,c===0&&(this.value=l),a.rotation=this.rotation(l)}),typeof((s=t.ui_update)==null?void 0:s.class)=="string"&&this.updateDynamicClass(t.ui_update.class),"class"in t&&this.updateDynamicClass(t.class)},updateDynamicClass:function(t){this.class=`${this.props.myclass} ${t}`},recalcNeedlePositions:function(){this.needles.forEach((t,e)=>{t.rotation=this.rotation(t.value)})},validate:function(t){let e;return typeof t!="number"?(e=parseFloat(t),isNaN(e)&&(e=null)):e=t,e},range:function(t,e,r){return e.maxIn>e.minIn?(t=Math.min(t,e.maxIn),t=Math.max(t,e.minIn)):(t=Math.min(t,e.minIn),t=Math.max(t,e.maxIn)),r?Math.round((t-e.minIn)/(e.maxIn-e.minIn)*(e.maxOut-e.minOut)+e.minOut):(t-e.minIn)/(e.maxIn-e.minIn)*(e.maxOut-e.minOut)+e.minOut},generateNumbers:function(t,e,r){let n,s,a;e>t?(n=this.arc.startDegrees,s=this.arc.endDegrees,a=t):(n=this.arc.endDegrees,s=this.arc.startDegrees,a=e);const c=Math.floor(Math.abs(e-t)/r+.1),u=(s-n)*r/Math.abs(e-t);let m=[];for(let d=0;d<=c;d++){let T=d*u+n;const P=(a+d*r).toFixed(this.scaleDecimalPlaces);m.push({r:T,n:P})}return m},rotation:function(t){this.arc.endDegrees-this.arc.startDegrees;let e=this.calcRotationLimitDegrees();e<this.arc.sweepAngle/2&&(e=this.arc.sweepAngle/2);const r=-e,n=e,s=(e-this.arc.sweepAngle/2)*(this.max-this.min)/this.arc.sweepAngle,a=this.min-s,c=this.max+s,l={minIn:a,maxIn:c,minOut:r,maxOut:n};return t===null&&(t=Math.min(a,c)),`${this.range(t,l,!1)}deg`},calcTickStyle:function(t,e){const r=this.arc.arcLength,n=Math.abs(this.max-this.min),s=t/n*r;return`stroke-dasharray: ${e} ${s-e}; stroke-dashoffset: ${e/2};`},calcSectorStyles:function(){this.sectors.forEach((t,e)=>{this.sectorStrokeStyles[e]=this.calcStrokeStyle(e)})},calcTextPositions:function(){this.measurement&&this.measurement.length>0?(this.unitsTextY=this.arc.cy+11,this.valueTextY=this.arc.cy+26):(this.unitsTextY=this.arc.cy-23,this.valueTextY=this.arc.cy-8)},calcNeedlePath:function(t,e){const r=this.arc.cx,n=this.arc.cy,s=(this.arc.radius-4.5)*t/100;return`<path d="M ${r},${n} ${r-1.5},${n} ${r-.15},${n-s} ${r+.15},${n-s} ${r+1.5},${n} z"
                fill="${e}"></path>`},calcRotationLimitDegrees:function(){let t=Math.min(this.arc.sweepAngle/2+15,180);if(this.height){const r=100*(this.height/this.width)-this.arc.cy,n=this.arc.radius-4.5;if(r<n)if(r>0){const s=Math.acos(r/n)*57.2958;t=Math.min(180-s,this.arc.sweepAngle/2+15)}else t=this.arc.sweepAngle/2}return t}}},y=["viewBox"],g=["d"],x=["d"],_=["d"],w=["y"],k={class:"label",y:"0",x:"50%","text-anchor":"middle"},D=["y"],S=["y"],b=["y"],$=["innerHTML"],M=["cx","cy"];function N(t,e,r,n,s,a){return i.openBlock(),i.createElementBlock("div",{class:i.normalizeClass(["ui-gauge-cl-wrapper",s.class]),style:i.normalizeStyle(a.wrapperStyle),ref:"wrapper"},[(i.openBlock(),i.createElementBlock("svg",{class:"cl-gauge",ref:"cl-gauge",width:"100%",height:"100%",viewBox:a.theViewBox,style:i.normalizeStyle(`--dash: ${this.arc.arcLength};`)},[i.createElementVNode("g",null,[(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(s.sectors,(c,l)=>(i.openBlock(),i.createElementBlock("path",{key:l,ref_for:!0,ref:"sector-"+l,class:"sector","stroke-width":"5",d:a.arcspec,style:i.normalizeStyle(this.sectorStrokeStyles[l])},null,12,g))),128)),i.createElementVNode("path",{class:"tick-minor","stroke-width":"5",d:a.arcspec,style:i.normalizeStyle(this.minorTickStyle)},null,12,x),i.createElementVNode("path",{ref:"arc",class:"tick-major","stroke-width":"5",d:a.arcspec,style:i.normalizeStyle(this.majorTickStyle)},null,12,_),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(a.numbers,(c,l)=>(i.openBlock(),i.createElementBlock("g",{class:"num-wrap",key:l,style:i.normalizeStyle(`--to-x: ${this.arc.cx}; --to-y:${this.arc.cy/this.widgetSizeRatio}; --t-r:${c.r}; --tt-x:${this.arc.cx}; --tt-y:${this.arc.cy/s.widgetSizeRatio};`)},[i.createElementVNode("text",{class:"num","text-anchor":"middle",y:`${10.5-this.arc.radius}`},i.toDisplayString(c.n),9,w)],4))),128)),i.createElementVNode("text",k,i.toDisplayString(s.label),1),i.createElementVNode("text",{class:"measurement",y:`${this.arc.cy-16}`,x:"50%","text-anchor":"middle"},i.toDisplayString(s.measurement),9,D),i.createElementVNode("text",{class:"units",y:`${this.unitsTextY}`,x:"50%","text-anchor":"middle"},i.toDisplayString(s.units),9,S),i.createElementVNode("text",{class:"value",y:`${this.valueTextY}`,x:"50%","text-anchor":"middle"},i.toDisplayString(a.displayValue),9,b)]),(i.openBlock(!0),i.createElementBlock(i.Fragment,null,i.renderList(s.needles,(c,l)=>(i.openBlock(),i.createElementBlock("g",{class:i.normalizeClass(`o-needle o-needle-${l+1}`),style:i.normalizeStyle(`transform-box: fill-box; transform-origin: 50% 100%; rotate: ${c.rotation};`),innerHTML:c.path},null,14,$))),256)),i.createElementVNode("g",null,[i.createElementVNode("circle",{class:"hub",cx:`${this.arc.cx}`,cy:`${this.arc.cy}`,r:"3",style:i.normalizeStyle(`fill: ${this.hubcolor}`)},null,12,M)])],12,y))],6)}const I=p(f,[["render",N],["__scopeId","data-v-7a3aec5f"]]);o.UIGaugeClassic=I,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
