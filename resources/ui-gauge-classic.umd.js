(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".ui-gauge-cl-wrapper[data-v-7763aef7]{padding:10px;margin:10px;border:1px solid black}.ui-gauge-cl-class[data-v-7763aef7]{color:green;font-weight:700}.cl-gauge[data-v-7763aef7]{position:relative}.cl-gauge .label[data-v-7763aef7]{fill:currentColor;font-size:.5rem;dominant-baseline:hanging}.cl-gauge .value[data-v-7763aef7]{fill:currentColor}.cl-gauge .units[data-v-7763aef7]{fill:currentColor;font-size:.4rem}.cl-gauge .measurement[data-v-7763aef7]{fill:currentColor;font-size:.5rem}.cl-gauge .num[data-v-7763aef7]{fill:currentColor;fill-opacity:.6;font-size:.35rem}.cl-gauge .tick-minor[data-v-7763aef7]{fill:none;stroke:currentColor;stroke-opacity:.6}.cl-gauge .tick-major[data-v-7763aef7]{fill:none;stroke:currentColor}.cl-gauge .sector[data-v-7763aef7]{fill:none;stroke:transparent}.cl-gauge .o-needle[data-v-7763aef7]{transition:.5s}")),document.head.appendChild(e)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}})();
(function(h,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("vuex"),require("vue")):typeof define=="function"&&define.amd?define(["exports","vuex","vue"],m):(h=typeof globalThis<"u"?globalThis:h||self,m(h["ui-gauge-classic"]={},h.vuex,h.Vue))})(this,function(h,m,s){"use strict";const f=(t,e)=>{const a=t.__vccOpts||t;for(const[r,i]of e)a[r]=i;return a},y={name:"UIGaugeClassic",inject:["$socket"],props:{id:{type:String,required:!0},props:{type:Object,default:()=>({})},state:{type:Object,default:()=>({enabled:!1,visible:!1})}},setup(t){},data(){return{min:0,max:1,majorDivision:10,minorDivision:5,units:"",label:"",measurement:"",valueDecimalPlaces:2,scaleDecimalPlaces:1,width:4,height:4,sectors:[],arc:{cx:50,cy:64,radius:47.5,startDegrees:-123,endDegrees:123,sweepAngle:246,startx:10,starty:90,endx:90,endy:90,arcLength:100},class:"",value:null,needles:[],widgetSizeRatio:1,unitsTextY:0,valueTextY:0,sectorStrokeStyles:[],majorTickStyle:"",minorTickStyle:""}},computed:{...m.mapState("data",["messages"]),wrapperStyle:function(){let t=this.props.height;return t||(t="null"),`grid-row-end: span ${t};`},arcspec:function(){const e=this.arc.endDegrees-this.arc.startDegrees>180?1:0;return`M ${this.arc.startx} ${this.arc.starty} A ${this.arc.radius} ${this.arc.radius} 0 ${e} 1 ${this.arc.endx} ${this.arc.endy}`},formattedValue:function(){return this.value!==null?this.value.toFixed(this.valueDecimalPlaces):"---"},numbers:function(){return this.generateNumbers(this.min,this.max,this.majorDivision)},theViewBox(){let t=100*this.props.height/this.props.width;return(isNaN(t)||!t)&&(t=100),`0 0 100 ${t}`}},mounted(){this.$socket.on("widget-load:"+this.id,t=>{this.processMsg(t)}),this.$socket.on("msg-input:"+this.id,t=>{this.processMsg(t),this.$store.commit("data/bind",{widgetId:this.id,msg:t})}),this.pickupProperties(),this.needles.forEach(t=>{t.rotation=this.rotation(null)}),this.$socket.emit("widget-load",this.id)},unmounted(){var t,e;(t=this.$socket)==null||t.off("widget-load"+this.id),(e=this.$socket)==null||e.off("msg-input:"+this.id)},methods:{pickupProperties:function(){const t=this.props;this.min=Number(t.min),this.max=Number(t.max),this.width=Number(t.width),this.height=Number(t.height),this.sectors=t.sectors,this.majorDivision=Number(t.major_division),this.minorDivision=Number(t.minor_division),this.valueDecimalPlaces=Number(t.value_decimal_places),this.scaleDecimalPlaces=Number(t.scale_decimal_places),this.label=t.label,this.units=t.units,this.measurement=t.measurement,this.needles=t.needles,this.arc.sweepAngle=t.sweep_angle||246,this.class=t.myclass,this.calculateDerivedValues()},calcStrokeStyle:function(t){const e=this.sectors[t],a={minIn:this.min,maxIn:this.max,minOut:0,maxOut:this.arc.arcLength},r=this.range(e.start,a,!1);let i;t>=this.sectors.length-1?i=Math.max(this.max,this.min):i=this.sectors[t+1].start;const n=this.range(i,a,!1),c=Math.min(r,n),o=Math.max(r,n)-c;return`stroke-dasharray: 0 ${c} ${o} var(--dash); stroke: ${e.color};`},calculateDerivedValues:function(){this.majorDivision=this.majorDivision<=0?1:this.majorDivision,this.minorDivision=this.minorDivision<=0?1:this.minorDivision,this.arc.radius=47.5,this.label&&this.label.length>0?this.arc.cy=64:(this.arc.cy=50,this.height/this.width==.5&&(this.arc.radius-=2,this.arc.cy-=2.5)),this.measurement&&this.measurement.length>0?(this.unitsTextY=this.arc.cy+11,this.valueTextY=this.arc.cy+26):(this.unitsTextY=this.arc.cy-23,this.valueTextY=this.arc.cy-8),this.arc.sweepAngle&&(this.arc.sweepAngle=Math.min(360,this.arc.sweepAngle),this.arc.startDegrees=-this.arc.sweepAngle/2,this.arc.endDegrees=this.arc.sweepAngle/2);const r=this.arc.startDegrees*Math.PI/180,i=this.arc.endDegrees*Math.PI/180;this.arc.startx=this.arc.cx-this.arc.radius*Math.sin(r-Math.PI),this.arc.starty=this.arc.cy+this.arc.radius*Math.cos(r-Math.PI),this.arc.endx=this.arc.cx+this.arc.radius*Math.sin(Math.PI-i),this.arc.endy=this.arc.cy+this.arc.radius*Math.cos(Math.PI-i),this.arc.arcLength=2*Math.PI*this.arc.radius*(this.arc.endDegrees-this.arc.startDegrees)/360,this.widgetSizeRatio=this.height/this.width,(isNaN(this.widgetSizeRatio)||!this.widgetSizeRatio)&&(this.widgetSizeRatio=1),this.sectors.forEach((n,c)=>{this.sectorStrokeStyles[c]=this.calcStrokeStyle(c)}),this.minorTickStyle=this.calcTickStyle(this.minorDivision,.5),this.majorTickStyle=this.calcTickStyle(this.majorDivision,1),this.needles.forEach(n=>{n.path=this.calcNeedlePath(n.lengthPercent,n.color)})},processMsg:function(t){t.needles&&this.needles.forEach((e,a)=>{var i;const r=this.validate((i=t.needles[a])==null?void 0:i.value);a===0&&(this.value=r),e.rotation=this.rotation(r)})},validate:function(t){let e;return typeof t!="number"?(e=parseFloat(t),isNaN(e)&&(e=null)):e=t,e},range:function(t,e,a){return e.maxIn>e.minIn?(t=Math.min(t,e.maxIn),t=Math.max(t,e.minIn)):(t=Math.min(t,e.minIn),t=Math.max(t,e.maxIn)),a?Math.round((t-e.minIn)/(e.maxIn-e.minIn)*(e.maxOut-e.minOut)+e.minOut):(t-e.minIn)/(e.maxIn-e.minIn)*(e.maxOut-e.minOut)+e.minOut},generateNumbers:function(t,e,a){let r,i,n;e>t?(r=this.arc.startDegrees,i=this.arc.endDegrees,n=t):(r=this.arc.endDegrees,i=this.arc.startDegrees,n=e);const c=Math.floor(Math.abs(e-t)/a+.1),d=(i-r)*a/Math.abs(e-t);let u=[];for(let l=0;l<=c;l++){let g=l*d+r;const T=(n+l*a).toFixed(this.scaleDecimalPlaces);u.push({r:g,n:T})}return u},rotation:function(t){const e=this.height/this.width==.5?.02:.1,a=this.arc.endDegrees-this.arc.startDegrees,r=360-a,i=Math.min(e,r/2/a),n=(this.max-this.min)*i,c=a*i,o=this.min-n,d=this.max+n,u=this.arc.startDegrees-c,l=this.arc.endDegrees+c,g={minIn:o,maxIn:d,minOut:u,maxOut:l};return t===null&&(t=Math.min(o,d)),`${this.range(t,g,!1)}deg`},calcTickStyle:function(t,e){const a=this.arc.arcLength,r=Math.abs(this.max-this.min),i=t/r*a;return`stroke-dasharray: ${e} ${i-e}; stroke-dashoffset: ${e/2};`},calcNeedlePath:function(t,e){const a=this.arc.cx,r=this.arc.cy,i=(this.arc.radius-4.5)*t/100;return`<path d="M ${a},${r} ${a-1.5},${r} ${a-.15},${r-i} ${a+.15},${r-i} ${a+1.5},${r} z"
                fill="${e}"></path>`}}},x=["viewBox"],p=["d"],k=["d"],D=["d"],S=["y"],w={class:"label",y:"0",x:"50%","text-anchor":"middle"},_=["y"],$=["y"],M=["y"],b=["innerHTML"],I=["cx","cy"];function N(t,e,a,r,i,n){return s.openBlock(),s.createElementBlock("div",{className:"ui-gauge-cl-wrapper",class:s.normalizeClass(i.class),style:s.normalizeStyle(n.wrapperStyle)},[(s.openBlock(),s.createElementBlock("svg",{class:"cl-gauge",ref:"cl-gauge",width:"100%",height:"100%",viewBox:n.theViewBox,style:s.normalizeStyle(`--dash: ${this.arc.arcLength};`)},[s.createElementVNode("g",null,[(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(i.sectors,(c,o)=>(s.openBlock(),s.createElementBlock("path",{key:o,ref_for:!0,ref:"sector-"+o,class:"sector","stroke-width":"5",d:n.arcspec,style:s.normalizeStyle(this.sectorStrokeStyles[o])},null,12,p))),128)),s.createElementVNode("path",{class:"tick-minor","stroke-width":"5",d:n.arcspec,style:s.normalizeStyle(this.minorTickStyle)},null,12,k),s.createElementVNode("path",{ref:"arc",class:"tick-major","stroke-width":"5",d:n.arcspec,style:s.normalizeStyle(this.majorTickStyle)},null,12,D),(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(n.numbers,(c,o)=>(s.openBlock(),s.createElementBlock("text",{key:o,class:"num","text-anchor":"middle",y:`${10.5-this.arc.radius}`,style:s.normalizeStyle(`rotate: ${c.r}deg; transform-origin: ${this.arc.cx}% ${this.arc.cy/this.widgetSizeRatio}%; transform: translate(${this.arc.cx}%, ${this.arc.cy/i.widgetSizeRatio}%)`)},s.toDisplayString(c.n),13,S))),128)),s.createElementVNode("text",w,s.toDisplayString(i.label),1),s.createElementVNode("text",{class:"measurement",y:`${this.arc.cy-16}`,x:"50%","text-anchor":"middle"},s.toDisplayString(i.measurement),9,_),s.createElementVNode("text",{class:"units",y:`${this.unitsTextY}`,x:"50%","text-anchor":"middle"},s.toDisplayString(i.units),9,$),s.createElementVNode("text",{class:"value",y:`${this.valueTextY}`,x:"50%","text-anchor":"middle"},s.toDisplayString(n.formattedValue),9,M)]),(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(i.needles,(c,o)=>(s.openBlock(),s.createElementBlock("g",{ref_for:!0,ref:"o-needle-"+o,class:"o-needle",style:s.normalizeStyle(`transform-box: fill-box; transform-origin: 50% 100%; rotate: ${c.rotation};`),innerHTML:c.path},null,12,b))),256)),s.createElementVNode("g",null,[s.createElementVNode("circle",{class:"hub",cx:`${this.arc.cx}`,cy:`${this.arc.cy}`,r:"3"},null,8,I)])],12,x))],6)}const E=f(y,[["render",N],["__scopeId","data-v-7763aef7"]]);h.UIGaugeClassic=E,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
